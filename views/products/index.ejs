<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Farm Fresh Market - All Products</title>
    <!-- Bootstrap 5 CSS (Lux theme from Bootswatch) -->
    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/lux/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Your custom CSS -->
    <link rel="stylesheet" href="/css/index.css">
</head>
<body>
    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-2 fw-bold mb-3 hero-title">
                        <i class="fas fa-seedling me-3"></i>Farm Fresh Market
                    </h1>
                    <p class="lead hero-subtitle">
                        Discover our premium selection of fresh, organic produce sourced directly from local farms.
                    </p>
                    <div class="hero-stats">
                        <div class="stat-item">
                            <span class="stat-number" id="productCount"><%= products.length %></span>
                            <span class="stat-label">Fresh Products</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">100%</span>
                            <span class="stat-label">Organic</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">Daily</span>
                            <span class="stat-label">Fresh Delivery</span>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4 text-center">
                    <div class="hero-icons">
                        <i class="fas fa-apple-alt hero-icon fruit-icon"></i>
                        <i class="fas fa-carrot hero-icon vegetable-icon"></i>
                        <i class="fas fa-cheese hero-icon dairy-icon"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation & Actions -->
    <div class="container">
        <div class="actions-bar">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <h2 class="section-title mb-0">
                        <i class="fas fa-shopping-basket me-2"></i>
                        Our Fresh Products
                    </h2>
                </div>
                <div class="col-lg-6 text-lg-end">
                    <a href="/products/new" class="btn btn-add-product">
                        <i class="fas fa-plus me-2"></i>Add New Product
                    </a>
                </div>
            </div>
            
            <!-- Filter & Search -->
            <div class="row mt-4">
                <div class="col-lg-8">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                        <label for="searchInput"></label><input type="text" id="searchInput" class="form-control search-input"
                                                                placeholder="Search products by name...">
                        <button class="btn btn-clear-search" id="clearSearch" style="display: none;">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="col-lg-4">
                    <label for="categoryFilter"></label><select class="form-select filter-select" id="categoryFilter">
                        <option value="all">All Categories</option>
                        <option value="fruit">üçé Fruits</option>
                        <option value="vegetable">ü•ï Vegetables</option>
                        <option value="dairy">üßÄ Dairy</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Products Grid -->
        <div class="products-section">
            <% if (products.length === 0) { %>
                <!-- Empty State -->
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-shopping-basket"></i>
                    </div>
                    <h3>No Products Yet</h3>
                    <p class="text-muted">Start building your fresh product catalog!</p>
                    <a href="/products/new" class="btn btn-add-product">
                        <i class="fas fa-plus me-2"></i>Add Your First Product
                    </a>
                </div>
            <% } else { %>
                <div class="row" id="productsGrid">
                    <% for(let product of products) { %>
                        <div class="col-lg-4 col-md-6 mb-4 product-item" 
                             data-category="<%= product.category %>" 
                             data-name="<%= product.name.toLowerCase() %>">
                            <div class="product-card">
                                <!-- Product Header -->
                                <div class="product-header">
                                    <div class="category-badge category-<%= product.category %>">
                                        <% if(product.category === 'fruit') { %>
                                            <i class="fas fa-apple-alt"></i>
                                            <span>Fresh Fruit</span>
                                        <% } else if(product.category === 'vegetable') { %>
                                            <i class="fas fa-carrot"></i>
                                            <span>Fresh Vegetable</span>
                                        <% } else { %>
                                            <i class="fas fa-cheese"></i>
                                            <span>Dairy Product</span>
                                        <% } %>
                                    </div>
                                    <div class="product-actions">
                                        <div class="dropdown">
                                            <button class="btn btn-action-menu" data-bs-toggle="dropdown">
                                                <i class="fas fa-ellipsis-v"></i>
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li>
                                                    <a class="dropdown-item" href="/products/<%= product._id %>">
                                                        <i class="fas fa-eye me-2"></i>View Details
                                                    </a>
                                                </li>
                                                <li>
                                                    <a class="dropdown-item" href="/products/<%= product._id %>/edit">
                                                        <i class="fas fa-edit me-2"></i>Edit Product
                                                    </a>
                                                </li>
                                                <li><hr class="dropdown-divider"></li>
                                                <li>
                                                    <a class="dropdown-item text-danger delete-product" href="#" 
                                                       data-product-id="<%= product._id %>" 
                                                       data-product-name="<%= product.name %>">
                                                        <i class="fas fa-trash me-2"></i>Delete Product
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>

                                <!-- Product Icon -->
                                <div class="product-icon-section">
                                    <% if(product.category === 'fruit') { %>
                                        <i class="fas fa-apple-alt product-icon text-success"></i>
                                    <% } else if(product.category === 'vegetable') { %>
                                        <i class="fas fa-carrot product-icon text-warning"></i>
                                    <% } else { %>
                                        <i class="fas fa-cheese product-icon text-info"></i>
                                    <% } %>
                                </div>

                                <!-- Product Info -->
                                <div class="product-info">
                                    <h4 class="product-name">
                                        <a href="/products/<%= product._id %>"><%= product.name %></a>
                                    </h4>
                                    <div class="product-price">
                                        $<span class="price-amount"><%= product.price.toFixed(2) %></span>
                                    </div>
                                    <div class="product-meta">
                                        <span class="product-id">ID: #<%= product._id.toString().slice(-6).toUpperCase() %></span>
                                    </div>
                                </div>

                                <!-- Product Footer -->
                                <div class="product-footer">
                                    <a href="/products/<%= product._id %>" class="btn btn-view-product">
                                        <i class="fas fa-eye me-2"></i>View Details
                                    </a>
                                </div>
                            </div>
                        </div>
                    <% } %>
                </div>

                <!-- No Results Message -->
                <div class="no-results" id="noResults" style="display: none;">
                    <div class="text-center">
                        <i class="fas fa-search fa-3x text-muted mb-3"></i>
                        <h4>No products found</h4>
                        <p class="text-muted">Try adjusting your search or filter criteria.</p>
                        <button class="btn btn-outline-primary" id="clearFilters">
                            <i class="fas fa-refresh me-2"></i>Clear Filters
                        </button>
                    </div>
                </div>
            <% } %>
        </div>

        <!-- Summary Stats -->
        <% if (products.length > 0) { %>
            <div class="summary-section">
                <div class="row">
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i class="fas fa-apple-alt text-success"></i>
                            </div>
                            <div class="summary-info">
                                <h5 id="fruitCount"><%= products.filter(p => p.category === 'fruit').length %></h5>
                                <small>Fresh Fruits</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i class="fas fa-carrot text-warning"></i>
                            </div>
                            <div class="summary-info">
                                <h5 id="vegetableCount"><%= products.filter(p => p.category === 'vegetable').length %></h5>
                                <small>Fresh Vegetables</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i class="fas fa-cheese text-info"></i>
                            </div>
                            <div class="summary-info">
                                <h5 id="dairyCount"><%= products.filter(p => p.category === 'dairy').length %></h5>
                                <small>Dairy Products</small>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-3 col-md-6 mb-3">
                        <div class="summary-card">
                            <div class="summary-icon">
                                <i class="fas fa-dollar-sign text-primary"></i>
                            </div>
                            <div class="summary-info">
                                <h5 id="avgPrice">$<%= (products.reduce((sum, p) => sum + p.price, 0) / products.length).toFixed(2) %></h5>
                                <small>Average Price</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        <% } %>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-light py-5 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-lg-4 mb-4">
                    <h5><i class="fas fa-seedling me-2"></i>Farm Fresh Market</h5>
                    <p class="text-muted">Your trusted source for fresh, organic produce delivered straight from local farms to your table.</p>
                    <div class="social-links">
                        <a href="#" class="social-link"><i class="fab fa-facebook"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-instagram"></i></a>
                        <a href="#" class="social-link"><i class="fab fa-twitter"></i></a>
                    </div>
                </div>
                <div class="col-lg-4 mb-4">
                    <h6>Quick Actions</h6>
                    <ul class="list-unstyled">
                        <li><a href="/products" class="text-muted text-decoration-none">View All Products</a></li>
                        <li><a href="/products/new" class="text-muted text-decoration-none">Add New Product</a></li>
                        <li><a href="#" class="text-muted text-decoration-none">About Our Farm</a></li>
                        <li><a href="#" class="text-muted text-decoration-none">Contact Us</a></li>
                    </ul>
                </div>
                <div class="col-lg-4 mb-4">
                    <h6>Farm Fresh Promise</h6>
                    <p class="text-muted mb-1">
                        <i class="fas fa-check-circle text-success me-2"></i>100% Organic
                    </p>
                    <p class="text-muted mb-1">
                        <i class="fas fa-check-circle text-success me-2"></i>Daily Fresh Delivery
                    </p>
                    <p class="text-muted">
                        <i class="fas fa-check-circle text-success me-2"></i>Local Farm Support
                    </p>
                </div>
            </div>
            <hr class="my-4">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="text-muted mb-0">&copy; 2024 Farm Fresh Market. All rights reserved.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <small class="text-muted">Made with <i class="fas fa-heart text-danger"></i> for fresh produce lovers</small>
                </div>
            </div>
        </div>
    </footer>

    <!-- Delete Confirmation Modal -->
    <div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="modal-title" id="deleteModalLabel">
                        <i class="fas fa-exclamation-triangle text-warning me-2"></i>
                        Confirm Deletion
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <p>Are you sure you want to delete <strong id="productNameToDelete"></strong>?</p>
                    <p class="text-muted mb-0">This action cannot be undone.</p>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="fas fa-times me-2"></i>Cancel
                    </button>
                    <form id="deleteForm" method="POST" style="display: inline;">
                        <input type="hidden" name="_method" value="DELETE">
                        <button type="submit" class="btn btn-danger">
                            <i class="fas fa-trash me-2"></i>Delete Product
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Pass products data to JavaScript -->
    <script>
        window.productsData = {
            products: '<%- JSON.stringify(products) %>',
            totalCount: '<%= products.length %>',
            categories: {
                fruit: '<%= products.filter(p => p.category === 'fruit').length %>',
                vegetable: '<%= products.filter(p => p.category === 'vegetable').length %>',
                dairy: '<%= products.filter(p => p.category === 'dairy').length %>'
            }
        };
    </script>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Your custom JavaScript -->
    <script src="/js/index.js"></script>
</body>
</html>