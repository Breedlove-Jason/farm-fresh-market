<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Add New Product - Farm Fresh Market</title>
    <!-- Bootstrap 5 CSS (Lux theme from Bootswatch) -->
    <link href="https://cdn.jsdelivr.net/npm/bootswatch@5.3.2/dist/lux/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/form.css">
</head>
<body>
    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <a href="/farms/<%= farmId %>" class="btn btn-back mb-3">
                        <i class="fas fa-arrow-left me-2"></i>Back to Farm
                    </a>
                    <h1 class="display-4 fw-bold mb-2">
                        <i class="fas fa-plus-circle me-3"></i>Add New Product
                    </h1>
                    <p class="lead">Expand your fresh product inventory</p>
                </div>
                <div class="col-lg-4 text-end">
                    <i class="fas fa-seedling" style="font-size: 6rem; opacity: 0.3;"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Form Container -->
        <div class="row justify-content-center">
            <div class="col-lg-8 col-xl-6">
                <div class="form-container">
                    <!-- Form Header -->
                    <div class="form-header">
                        <h2 class="fw-bold text-dark mb-2">
                            <i class="fas fa-shopping-basket text-primary me-2"></i>
                            Product Information
                        </h2>
                        <p class="text-muted mb-0">Fill in the details for your new product</p>
                    </div>

                    <!-- Product Form -->
                    <form action="/farms/<%= farmId %>/products" method="POST" id="productForm">
                        <!-- Hidden field for farm ID -->
                        <input type="hidden" name="farm" value="<%= farmId %>">
                        <!-- Product Name -->
                        <div class="form-floating">
                            <input 
                                type="text" 
                                class="form-control" 
                                id="productName" 
                                name="name" 
                                placeholder="Product Name"
                                required
                                autocomplete="off"
                            >
                            <label for="productName">
                                <i class="fas fa-tag input-icon"></i>Product Name
                            </label>
                        </div>

                        <!-- Product Price -->
                        <div class="form-floating">
                            <input 
                                type="number" 
                                class="form-control" 
                                id="productPrice" 
                                name="price" 
                                placeholder="0.00"
                                step="0.01" 
                                min="0"
                                required
                                autocomplete="off"
                            >
                            <label for="productPrice">
                                <i class="fas fa-dollar-sign input-icon"></i>Price (USD)
                            </label>
                            <!-- Price Preview -->
                            <div class="price-preview" id="pricePreview">
                                <h5 class="mb-0">$<span id="priceDisplay">0.00</span></h5>
                                <small>Product Price</small>
                            </div>
                        </div>

                        <!-- Product Category -->
                        <div class="form-floating">
                            <select class="form-select" id="productCategory" name="category" required>
                                <option value="" disabled selected>Choose a category...</option>
                                <option value="fruit">üçé Fruit</option>
                                <option value="vegetable">ü•ï Vegetable</option>
                                <option value="dairy">üßÄ Dairy</option>
                            </select>
                            <label for="productCategory">
                                <i class="fas fa-list input-icon"></i>Product Category
                            </label>
                            <!-- Category Preview -->
                            <div class="category-preview" id="categoryPreview">
                                <i class="fas fa-apple-alt fa-2x mb-2" id="categoryIcon"></i>
                                <h6 class="mb-0" id="categoryText">Category Selected</h6>
                            </div>
                        </div>

                        <!-- Form Actions -->
                        <div class="row mt-4">
                            <div class="col-12">
                                <button type="submit" class="btn btn-submit">
                                    <i class="fas fa-plus-circle me-2"></i>Add Product to Inventory
                                </button>
                            </div>
                        </div>

                        <!-- Form Help Text -->
                        <div class="text-center mt-3">
                            <small class="text-muted">
                                <i class="fas fa-info-circle me-1"></i>
                                All fields are required. Product will be added to your inventory immediately.
                            </small>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Product Preview Section -->
        <div class="row justify-content-center mt-4" id="productPreview" style="display: none;">
            <div class="col-lg-8 col-xl-6">
                <div class="card border-0 shadow-sm" style="border-radius: 20px;">
                    <div class="card-header bg-transparent border-0 text-center py-3">
                        <h5 class="mb-0 fw-bold text-primary">
                            <i class="fas fa-eye me-2"></i>Product Preview
                        </h5>
                    </div>
                    <div class="card-body text-center">
                        <div class="mb-3">
                            <i class="fas fa-apple-alt fa-3x text-primary mb-2" id="previewIcon"></i>
                            <h4 class="fw-bold" id="previewName">Product Name</h4>
                        </div>
                        <div class="row">
                            <div class="col-6">
                                <div class="bg-light rounded p-2">
                                    <small class="text-muted">Price</small>
                                    <div class="fw-bold" id="previewPrice">$0.00</div>
                                </div>
                            </div>
                            <div class="col-6">
                                <div class="bg-light rounded p-2">
                                    <small class="text-muted">Category</small>
                                    <div class="fw-bold" id="previewCategory">Category</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4 mt-5">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5><i class="fas fa-seedling me-2"></i>Farm Fresh Market</h5>
                    <p class="text-muted">Your trusted source for fresh, organic produce</p>
                </div>
                <div class="col-md-6 text-end">
                    <p class="text-muted mb-0">
                        <i class="fas fa-phone me-2"></i>Call us: (555) 123-4567
                    </p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // Form elements
        const productName = document.getElementById('productName');
        const productPrice = document.getElementById('productPrice');
        const productCategory = document.getElementById('productCategory');
        const form = document.getElementById('productForm');

        // Preview elements
        const pricePreview = document.getElementById('pricePreview');
        const priceDisplay = document.getElementById('priceDisplay');
        const categoryPreview = document.getElementById('categoryPreview');
        const categoryIcon = document.getElementById('categoryIcon');
        const categoryText = document.getElementById('categoryText');

        // Product preview card
        const productPreview = document.getElementById('productPreview');
        const previewIcon = document.getElementById('previewIcon');
        const previewName = document.getElementById('previewName');
        const previewPrice = document.getElementById('previewPrice');
        const previewCategory = document.getElementById('previewCategory');

        // Price input handler
        productPrice.addEventListener('input', function() {
            const price = parseFloat(this.value) || 0;
            priceDisplay.textContent = price.toFixed(2);
            previewPrice.textContent = '$' + price.toFixed(2);

            if (this.value) {
                pricePreview.style.display = 'block';
            } else {
                pricePreview.style.display = 'none';
            }
            updatePreview();
        });

        // Category selector handler
        productCategory.addEventListener('change', function() {
            const category = this.value;
            let icon, text, iconClass;

            switch(category) {
                case 'fruit':
                    icon = 'fas fa-apple-alt';
                    iconClass = 'text-success';
                    text = 'Fresh Fruit';
                    break;
                case 'vegetable':
                    icon = 'fas fa-carrot';
                    iconClass = 'text-warning';
                    text = 'Fresh Vegetable';
                    break;
                case 'dairy':
                    icon = 'fas fa-cheese';
                    iconClass = 'text-info';
                    text = 'Dairy Product';
                    break;
                default:
                    categoryPreview.style.display = 'none';
                    return;
            }

            categoryIcon.className = icon + ' fa-2x mb-2 ' + iconClass;
            categoryText.textContent = text;
            categoryPreview.style.display = 'block';

            // Update preview card
            previewIcon.className = icon + ' fa-3x text-primary mb-2';
            previewCategory.textContent = text;

            updatePreview();
        });

        // Product name handler
        productName.addEventListener('input', function() {
            previewName.textContent = this.value || 'Product Name';
            updatePreview();
        });

        // Update preview visibility
        function updatePreview() {
            const hasName = productName.value.trim();
            const hasPrice = productPrice.value;
            const hasCategory = productCategory.value;

            if (hasName && hasPrice && hasCategory) {
                productPreview.style.display = 'block';
                productPreview.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            } else {
                productPreview.style.display = 'none';
            }
        }

        // Form submission with loading state
        form.addEventListener('submit', function(e) {
            const submitBtn = form.querySelector('.btn-submit');
            const originalText = submitBtn.innerHTML;

            // Add loading state
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Adding Product...';
            submitBtn.disabled = true;

            // Re-enable after 3 seconds (in case of errors)
            setTimeout(() => {
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
            }, 3000);
        });

        // Add entrance animations
        document.addEventListener('DOMContentLoaded', function() {
            const formContainer = document.querySelector('.form-container');
            formContainer.style.opacity = '0';
            formContainer.style.transform = 'translateY(30px)';

            setTimeout(() => {
                formContainer.style.transition = 'all 0.6s ease';
                formContainer.style.opacity = '1';
                formContainer.style.transform = 'translateY(0)';
            }, 200);
        });

        // Form validation feedback
        const inputs = document.querySelectorAll('.form-control, .form-select');
        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                if (this.checkValidity()) {
                    this.classList.remove('is-invalid');
                    this.classList.add('is-valid');
                } else {
                    this.classList.remove('is-valid');
                    this.classList.add('is-invalid');
                }
            });
        });
    </script>
</body>
</html>
